<html>
<head>
    <link href="style.css" rel="stylesheet" type="text/css">
    <meta charset="UTF-8">
    <title>Air Hokey</title>
</head>
    <body>
        <canvas id="canva" height="500px" width="1000px" >
            <script>
                var canvas = document.querySelector("#canva");
                var context = canvas.getContext("2d");

                var canvasPos = getPosition(canvas);
                var mouseX = 0;
                var mouseY = 0;

                var width = canvas.width;
                var height = canvas.height;

                //varablen berechnen
                    //feld player1
                    var a = 20;
                    var b = height-20;
                    var c = width/2-24;

                //Farben
                var color1 = "#ffffff";
                var color2 = "#d6183e";
                var color3 = "#1d90cf";

                document.write(width + " " + height);


                canvas.addEventListener("mousemove", setMousePosition, false);

                var player1 = new Player();
                var player2 = new Player2();
                update();


                function setMousePosition(e) {
                    //mit berechnung das player1 in feld1 bleibt
                    mouseX = (e.clientX - canvasPos.x<=c)?e.clientX - canvasPos.x:c;
                    mouseY = (e.clientY - canvasPos.y<=b)?e.clientY - canvasPos.y:b;
                    if(mouseX<=a||mouseY<=a){
                        (mouseX <= a)? mouseX=a:mouseX;
                        (mouseY <= a)? mouseY=a:mouseY;
                    } else {

                    }
                    context.clearRect(0, 0, width, height);
                    draw();
                }

                function update() {
                    context.clearRect(0, 0, width, height);
                    draw();
                    requestAnimationFrame(update);
                }



                // deal with the page getting resized or scrolled
                //window.addEventListener("scroll", updatePosition, false);
                //window.addEventListener("resize", updatePosition, false);

                function updatePosition() {
                    canvasPos = getPosition(canvas);
                }

                // Helper function to get an element's exact position
                function getPosition(el) {
                    var xPosition = 0;
                    var yPosition = 0;

                    while (el) {
                        xPosition += (el.offsetLeft - el.scrollLeft + el.clientLeft);
                        yPosition += (el.offsetTop - el.scrollTop + el.clientTop);
                        el = el.offsetParent;


                    }
                    return {
                        x: xPosition,
                        y: yPosition
                    };
                }

                function draw() {
                    //spielfeld
                    drawfeld();

                    //Player1 mit bewegen
                    context.beginPath();
                    context.arc(mouseX, mouseY, 20, 0, 2 * Math.PI, true);
                    context.fillStyle = color2;
                    context.fill();
                    context.beginPath();
                    context.arc(mouseX, mouseY, 8, 0, 2 * Math.PI, true);
                    context.lineWidth = 3;
                    context.strokeStyle = color1;
                    context.stroke();


                    //Player2 noch keine bewegung
                    context.beginPath();
                    context.arc(750, 250, 20, 0, 2 * Math.PI, true);
                    context.fillStyle = color2;
                    context.fill();
                    context.beginPath();
                    context.arc(750, 250, 8, 0, 2 * Math.PI, true);
                    context.lineWidth = 3;
                    context.strokeStyle = color1;
                    context.stroke();



                    //ausgeben von Maus Koordinaten
                    context.font = "30px Arial";
                    context.fillText("X: "+ mouseX + " Y:" + mouseY,500, 50);
                }

                function Schlaeger(x,y){
                    this.x = x;
                    this.y = y;
                }

                Schlaeger.prototype.draw = function () {
                    //Player1 mit bewegen
                    context.beginPath();
                    context.arc(this.x, this.y, 20, 0, 2 * Math.PI, true);
                    context.fillStyle = "#d6183e";
                    context.fill();
                    context.beginPath();
                    context.arc(this.x, this.y, 8, 0, 2 * Math.PI, true);
                    context.lineWidth = 3;
                    context.strokeStyle = "white";
                    context.stroke();
                };

                function Player() {
                    this.schlaeger = new Schlaeger(250,250);
                }

                Player.prototype.draw = function () {
                    this.schlaeger.draw();
                };

                function Player2() {
                    this.schlaeger = new Schlaeger(600,250);
                }

                Player2.prototype.draw = function(){
                    this.schlaeger.draw();
                };

                //zeichnet das Spielfeld
                function drawfeld() {
                    context.beginPath();
                    context.fillStyle = color1;
                    context.fillRect(0,0,width,height);
                    context.fill();
                    context.closePath();

                    context.beginPath();
                    context.fillStyle = color3;
                    context.lineWidth = 5;
                    context.strokeStyle = color3;
                    context.strokeRect(width/2-1, 0, 0, height*(1/4));
                    context.strokeRect(width/2-1, height*(3/4), 0, height*(1/4));
                    context.arc(width/2, height/2, height*(1/4), 0, 2 * Math.PI, true);
                    context.stroke();
                    context.closePath();

                    context.beginPath();
                    context.strokeStyle = color2;
                    context.arc(0, height/2, height*(1/8), 0, 2 * Math.PI, true);
                    context.moveTo(width, height/2);
                    context.arc(width, height/2, height*(1/8), 0, 2 * Math.PI, true);
                    context.stroke();
                    context.closePath();

                    context.beginPath();
                    context.arc(500, 250, 10, 0, 2 * Math.PI, true);
                    context.fill();
                }

            </script>
        </canvas>
    </body>
</html>